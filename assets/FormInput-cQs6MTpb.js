import{r as o,j as t,R as N}from"./index-qegmBwH1.js";import{u as J,p as E,I as K,A as Q}from"./AutoResizeHeight-pHZ_oyCK.js";import{c as P}from"./WrappedElementProvider-5243oAX6.js";import{j as w,s as W}from"./store-gmK8mRDy.js";import{a as _,b as Z}from"./init-a0893ef4-4662SO8Z.js";import{c as h,a as R}from"./helper-0r91fNX5.js";import{b as ee}from"./owner-4YVbz2PN.js";import"./toast-qMk_Ov--.js";import{u as A,a as te}from"./usePeek-N6a5Jy_H.js";import{m as se}from"./motion-minimal-gJqnz197.js";import{i as oe}from"./index-5Y6ZmVAf.js";import{m as re,i as ae}from"./lodash-Y39_oLIE.js";import{M as ne}from"./StyledButton-Mj8l6PeD.js";import{$ as le,_ as ie}from"./provider-jumr72cx.js";const ce=o.forwardRef((s,r)=>{const{className:n,children:e,...i}=s,l=A(0),c=A(0),f=o.useCallback(({clientX:x,clientY:a,currentTarget:u})=>{const m=u.getBoundingClientRect();l.set(x-m.left),c.set(a-m.top)},[l,c]),d=te`radial-gradient(320px circle at ${l}px ${c}px, var(--spotlight-color) 0%, transparent 85%)`,p=ee(),g=J(s);return t.jsxs("div",{className:"group relative h-full overflow-hidden [--spotlight-color:oklch(var(--a)_/_0.12)]",onMouseMove:f,children:[!p&&t.jsx(se.div,{className:"pointer-events-none absolute bottom-[-150px] left-0 right-0 top-0 z-0 rounded-xl opacity-0 transition-opacity duration-500 group-hover:opacity-100",style:{background:d},"aria-hidden":"true"}),t.jsx("textarea",{ref:r,className:h("h-full w-full resize-none bg-transparent","overflow-auto px-3 py-4","text-neutral-900/80 dark:text-slate-100/80",n),...i,...g}),e]})});ce.displayName="TextArea";const ue=o.forwardRef((s,r)=>o.createElement(le.label,ie({},s,{ref:r,onMouseDown:n=>{var e;(e=s.onMouseDown)===null||e===void 0||e.call(s,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault()}}))),V=ue,de=o.createContext({}),me=()=>o.useContext(de),M=o.forwardRef(({className:s,...r},n)=>{const e=me();return t.jsx(V,{ref:n,className:h("text-foreground-600 text-[1em] font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",s,e.className),...r})});M.displayName=V.displayName;const fe=({errorMessage:s,id:r})=>t.jsx("div",{className:"mt-2",children:t.jsx(M,{className:"text-xs font-medium text-error",htmlFor:r,children:s})}),pe=o.createContext({}),xe=()=>o.useContext(pe),be=N.forwardRef((s,r)=>{const{className:n,type:e,label:i,isLoading:l,errorMessage:c,isInvalid:f,endContent:d,labelPlacement:p,inputClassName:g,bindValue:x,...a}=s,u=o.useId(),m=xe(),{value:v,onChange:F,onBlur:L,onFocus:D,labelClassName:Ce,...T}=a,[$,k]=N.useState(!1),O=N.useCallback(()=>{k(!0)},[]),H=N.useCallback(()=>{k(!1)},[]),[U,I]=N.useState(a.value);o.useEffect(()=>{I(a.value)},[a.value]);const[j,X]=N.useState(!1),Y=re({},m,s),{labelPlacement:b="top"}=Y,q=h(m.inputClassName,s.labelClassName),G=h(m.inputClassName,s.inputClassName);return t.jsxs("div",{className:"flex w-full flex-col",children:[t.jsxs("div",{className:h({"flex flex-col":b==="top","flex flex-grow flex-row items-center":b==="left"},"peer relative",n),children:[i&&t.jsx(M,{className:R({"mr-4":b==="left","mb-2 flex":b==="top"},b==="inside"&&{"absolute left-3 top-2 z-[1] select-none duration-200":!0,"text-primary":$,"bottom-2 top-2 flex items-center text-lg":!v&&!$},q),htmlFor:u,children:i}),t.jsxs("div",{className:"relative flex-grow",children:[t.jsx("input",{id:u,value:ae(x)?U:x,onChange:C=>{I(C.target.value),F?.(C)},onBlur:C=>{H(),L?.(C)},onFocus:C=>{O(),D?.(C)},type:e==="password"&&!j?"password":"text",className:h("flex h-10 w-full rounded-md border px-3 py-2 text-sm","focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50","border-zinc-200 bg-white placeholder:text-slate-500 focus-visible:border-primary dark:border-neutral-800 dark:bg-zinc-900",b==="inside"&&"h-auto pb-2 pt-8",e==="password"&&["pr-6",!j&&"font-mono"],l&&"pr-6",f&&"!border-red-400 !bg-red-600/50",G),ref:r,...T}),e==="password"&&!l&&t.jsx(ne,{className:y({placement:b}),onClick:()=>{X(!j)},children:t.jsx("i",{className:R("text-lg text-gray-500",j?"icon-[mingcute--eye-line]":"icon-[mingcute--eye-close-line]")})}),!l&&d&&t.jsx("div",{className:y({placement:b}),children:d}),l&&t.jsx("div",{className:y({placement:b}),children:t.jsx("i",{className:"loading loading-spinner h-5 w-5 text-primary/80"})})]})]}),f&&c&&t.jsx(fe,{id:u,errorMessage:c})]})}),y=oe({base:"absolute right-2",variants:{placement:{inside:"bottom-2",left:"bottom-0 top-0 flex items-center",top:"bottom-0 top-0 flex items-center"}}});be.displayName="Input";_({});const S=o.createContext(null),z=o.createContext(null),B=()=>o.useContext(S),ge=()=>o.useContext(z),Ve=s=>{const{showErrorMessage:r=!0,...n}=s,e=P(()=>_({}));return t.jsx(S.Provider,{value:P(()=>({showErrorMessage:r,fields:e,getField:i=>w.get(e)[i],addField:(i,l)=>{w.set(e,c=>({...c,[i]:l}))},removeField:i=>{w.set(e,l=>{const c={...l};return delete c[i],c})}})),children:t.jsx(z.Provider,{value:o.useMemo(()=>({showErrorMessage:r}),[r]),children:t.jsx(he,{...n})})})},he=s=>{const{onSubmit:r,...n}=s,e=B().fields,i=o.useCallback(async l=>{l.preventDefault();const c=w.get(e);for await(const[f,d]of Object.entries(c)){const p=d.$ref;if(!p)continue;const g=p.value,x=d.rules;for(let a=0;a<x.length;a++){const u=x[a];try{if(!await u.validator(g)){console.error(`Form validation failed, at field \`${f}\`, got value \`${g}\``),p.focus(),u.message&&w.set(e,v=>E(v,F=>{F[f].rules[a].status="error"}));return}}catch(m){console.error("validate function throw error",m);return}}}r?.(l)},[r]);return t.jsx("form",{onSubmit:i,...n,children:s.children})},ve=o.memo(({className:s,rules:r,onKeyDown:n,...e})=>{const i=B();if(!i)throw new Error("FormInput must be used inside <FormContext />");const{showErrorMessage:l}=ge(),{addField:c,removeField:f,fields:d}=i,p=o.useRef(null),g=Z(W(d,o.useCallback(a=>{if(e.name)return a[e.name]?.rules.find(u=>u.status==="error")?.message},[e.name])));o.useEffect(()=>{const a=e.name;if(r&&a)return c(a,{rules:r,$ref:p.current}),()=>{f(a)}},[e.name,r]);const x=o.useCallback(a=>{n&&n(a),w.set(d,u=>E(u,m=>{e.name&&m[e.name].rules.forEach(v=>{v.status==="error"&&(v.status="success")})}))},[d,n,e.name]);return t.jsxs(t.Fragment,{children:[t.jsx(K,{ref:p,className:h(!!g&&"ring-2 ring-red-400 dark:ring-orange-700","w-full",s),type:"text",onKeyDown:x,...e}),l&&t.jsx(Q,{duration:.2,children:t.jsx("p",{className:"text-left text-sm text-red-400 dark:text-orange-700",children:g})})]})});ve.displayName="FormInput";export{Ve as F,ce as T,ve as a};
