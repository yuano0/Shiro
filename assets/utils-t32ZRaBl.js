import{j as a,r as d,_ as M,c as R,g as H}from"./index-qegmBwH1.js";import{x as F,y as V,m as x,k as h,i as B,z as I,A as O}from"./owner-4YVbz2PN.js";import"./toast-qMk_Ov--.js";import{j as K}from"./store-gmK8mRDy.js";import"./WrappedElementProvider-5243oAX6.js";import{a as u}from"./init-a0893ef4-4662SO8Z.js";import{c as U,d as Q,D as W,e as G}from"./provider-jumr72cx.js";import{A as $,a as X,m as Z}from"./spring--xEiX8r3.js";import{m as A}from"./motion-minimal-gJqnz197.js";import{d as Y}from"./Markdown-hVdCypI9.js";import"./StyledButton-Mj8l6PeD.js";import{r as T,R as C}from"./CurrentPostDataProvider-sxwUfZTo.js";import{c as E}from"./helper-0r91fNX5.js";import"./usePeek-N6a5Jy_H.js";import{d as J}from"./customParseFormat-3OBJgCTU.js";import{u as ee}from"./useQuery-44y7CkOR.js";import{A as P}from"./AutoResizeHeight-pHZ_oyCK.js";function Se(e){return a.jsx("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:a.jsx("path",{fill:"currentColor",d:"M12 20a8 8 0 0 0 8-8a8 8 0 0 0-8-8a8 8 0 0 0-8 8a8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10a10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67l-.75 1.23L11 13V7h1.5Z"})})}const N=u(""),S=u("");u("");u(!0);u(e=>{const r=e(N),t=e(S);return r!==""&&t!==""});u(e=>{const r=e(N),t=e(S);return r!==""&&t!==""});const te=d.createContext(!1),ze=e=>{const[r,t]=d.useState(!1),n=d.useRef(null);return d.useEffect(()=>{if(!n.current)return;const o=n.current;return o.oncopy=l=>{F()||(l.preventDefault(),t(!0))},()=>{o.oncopy=null}},[]),d.useEffect(()=>{if(r){const o=setTimeout(()=>{t(!1)},2e3);return()=>{clearTimeout(o)}}},[r]),a.jsxs(te.Provider,{value:!0,children:[a.jsx("div",{ref:n,children:e.children}),a.jsx(U,{open:!0,children:a.jsx($,{children:r&&a.jsxs(Q,{children:[a.jsx(W,{}),a.jsx(G,{asChild:!0,children:a.jsxs(A.div,{className:"fixed inset-0 z-[11] flex flex-col gap-4 center",exit:{opacity:0},onClick:()=>{t(!1)},children:[a.jsx("div",{className:"pointer-events-none mt-0 text-3xl font-medium text-red-400 dark:text-orange-500",children:"注意："}),a.jsx("div",{className:"pointer-events-none my-3 text-lg text-neutral-900 text-opacity-80 dark:text-zinc-100",children:a.jsx("p",{children:"本文章为站长原创，保留版权所有，禁止复制。"})})]})})]})})})]})};Y(()=>M(()=>import("./CommentRoot-gt5vN1ZY.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]),import.meta.url).then(e=>e.CommentAreaRoot));Y(()=>M(()=>import("./Comments-P8C4VA5P.js").then(e=>e.q),__vite__mapDeps([14,1,2,15,5,6,7,8,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]),import.meta.url).then(e=>e.Comments));const qe=Y(()=>M(()=>import("./index-_iJ2szeX.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]),import.meta.url).then(e=>e.CommentBoxRoot));var re={exports:{}};(function(e,r){(function(t,n){e.exports=n(V)})(R,function(t){function n(i){return i&&typeof i=="object"&&"default"in i?i:{default:i}}var o=n(t),l={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(i,s){return s==="W"?i+"周":i+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(i,s){var c=100*i+s;return c<600?"凌晨":c<900?"早上":c<1100?"上午":c<1300?"中午":c<1800?"下午":"晚上"}};return o.default.locale(l,null,!0),l})})(re);var z={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(R,function(){var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,o,l){var i=o.prototype,s=i.format;l.en.formats=t,i.format=function(c){c===void 0&&(c="YYYY-MM-DDTHH:mm:ssZ");var f=this.$locale().formats,y=function(g,_){return g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(v,D,p){var L=p&&p.toUpperCase();return D||_[p]||t[p]||_[L].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(k,j,q){return j||q.slice(1)})})}(c,f===void 0?{}:f);return s.call(this,y)}}})})(z);var ne=z.exports;const ae=H(ne);x.extend(J);x.extend(ae);x.locale("zh-cn");const oe=(e,r)=>x(e).format(r),w=(e,r=new Date)=>{if(!e)return"";e=new Date(e);const t=60*1e3,n=t*60,o=n*24,l=o*30,i=o*365,s=+r-+e;if(s<t){const c=Math.ceil(s/1e3);return c<=0?"刚刚":`${c} 秒前`}else return s<n?`${Math.round(s/t)} 分钟前`:s<o?`${Math.round(s/n)} 小时前`:s<l?`${Math.round(s/o)} 天前`:s<i?`${Math.round(s/l)} 个月前`:`${Math.round(s/i)} 年前`},b=e=>e,se={root:()=>b({queryKey:["aggregation"],queryFn:async()=>h.aggregate.getAggregateData("shiro").then(e=>e.$serialized),gcTime:1e3*60*10,meta:{forceHydration:!0},staleTime:B?1e3*60*10:void 0})},ie="latest",ce={byNid:(e,r)=>b({queryKey:["note",e],meta:{hydrationRoutePath:T(C.Note,{id:e}),shouldHydration:t=>{const n=t?.data;return!(n?.secret?x(n?.secret).isAfter(new Date):!1)}},queryFn:async({queryKey:t})=>{const[,n]=t;return n===ie?(await h.note.getLatest()).$serialized:{...await h.note.getNoteById(+t[1],r)}}})},le={bySlug:e=>b({queryKey:["page",e],meta:{hydrationRoutePath:T(C.Page,{slug:e})},queryFn:async({queryKey:r})=>{const[,t]=r;return(await h.page.getBySlug(t)).$serialized}})},de={bySlug:(e,r)=>b({queryKey:["post",e,r],meta:{hydrationRoutePath:T(C.Post,{category:e,slug:r})},queryFn:async({queryKey:t})=>{const[,n,o]=t;return(await h.post.getPost(n,o)).$serialized}})},He={aggregation:se,note:ce,post:de,page:le},ue=(e,r)=>{d.useEffect(()=>{I.fetchQuery({queryKey:["ack-read-count",e,r],queryFn:async()=>h.ack.read(e,r)})},[])},Fe=e=>(ue(e.type,e.id),null),Ve=({children:e,className:r,as:t="main"})=>a.jsx(t,{className:E("relative bg-slate-50 dark:bg-zinc-900 md:col-start-1 lg:col-auto","-m-4 p-[2rem_1rem] md:m-0 lg:p-[30px_45px]","rounded-[0_6px_6px_0] border-zinc-200/70 shadow-sm dark:border-neutral-800 dark:shadow-[#333] lg:border","note-layout-main","min-w-0","print:!border-none print:!bg-transparent print:!shadow-none",r),children:e});function me(e,r){const[t,n]=d.useState(e);return d.useEffect(()=>{const o=setTimeout(()=>{n(e)},r);return()=>{clearTimeout(o)}},[e,r]),t}const Be=e=>{const{children:r}=e,t=me(r,300);return a.jsx($,{mode:"popLayout",initial:!1,children:a.jsx(A.span,{initial:{opacity:0,y:-16},animate:{opacity:1,y:0},exit:{opacity:0,y:-16,position:"absolute"},transition:X,children:t},t)})};function fe(e=""){return new URL(e,O()?.url.webUrl)}function pe(e){return m(e.title)&&m(e.slug)&&!m(e.order)}function he(e){return m(e.title)&&m(e.slug)&&m(e.order)}function xe(e){return m(e.title)&&m(e.nid)}function ye(e){return pe(e)?e.category?`/posts/${e.category.slug}/${encodeURIComponent(e.slug)}`:(console.error("PostModel.category is missing!!!!!"),"#"):he(e)?`/${e.slug}`:xe(e)?`/notes/${e.nid}`:"/"}function m(e){return e!=null}fe.build=ye;u({x:0,y:0});u(!1);Y(()=>M(()=>import("./index-RlvYxWmQ.js"),__vite__mapDeps([48,1,2]),import.meta.url).then(e=>e.QRCodeSVG));const ge=u(!1),_e=()=>K.get(ge),Ie=e=>{const{from:r,to:t,initial:n,preset:o}=e,l=d.forwardRef((s,c)=>{const{timeout:f={},duration:y=.5,animation:g={},as:_="div",delay:v=0,lcpOptimization:D=!1,...p}=s,{enter:L=v,exit:k=v}=f,j=A[_];return a.jsx(j,{initial:d.useMemo(()=>D?_e()?n||r:!0:n||r,[]),ref:c,animate:{...t,transition:{duration:y,...o||Z,...g.enter,delay:L/1e3}},exit:{...r,transition:{duration:y,...g.exit,delay:k/1e3}},transition:{duration:y},...p,children:s.children})});l.displayName="forwardRef(TransitionView)";const i=d.memo(l);return i.displayName="MemoedTransitionView",i},Oe=e=>{const[r,t]=d.useState(w(e.date)),{displayAbsoluteTimeAfterDay:n=29}=e;return d.useEffect(()=>{t(w(e.date));let o=setInterval(()=>{t(w(e.date))},1e3);return Math.abs(x(e.date).diff(new Date,"d"))>n&&(o=clearInterval(o),t(oe(e.date,"YY 年 M 月 D 日"))),()=>{o=clearInterval(o)}},[e.date,n]),a.jsx(a.Fragment,{children:r})},Ke=e=>{const{cid:r}=e,{data:t,isLoading:n,error:o}=ee({queryKey:["getSummary",r],queryFn:async({queryKey:i})=>{const[,s]=i,c=await fetch(`/api/xlog/summary?cid=${s}`,{next:{revalidate:60*10}}).then(f=>f.json());if(!c)throw new Error("请求错误");if(!c.data)throw new Error("内容暂时无法获取");return c},enabled:!!r,staleTime:1e3*60*60*24*7,retryDelay:5e3});let l=a.jsxs("div",{className:E("space-y-2 rounded-xl border border-slate-200 p-4 dark:border-neutral-800",e.className),children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("i",{className:"icon-[mingcute--sparkles-line] mr-2 text-lg"}),"AI 生成的摘要"]}),a.jsxs(P,{duration:.3,children:[a.jsx("div",{className:"!m-0 text-sm leading-loose text-base-content/85",children:n?a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:"block h-5 w-full animate-pulse rounded-xl bg-zinc-200 dark:bg-neutral-800"}),a.jsx("span",{className:"block h-5 w-full animate-pulse rounded-xl bg-zinc-200 dark:bg-neutral-800"}),a.jsx("span",{className:"block h-5 w-full animate-pulse rounded-xl bg-zinc-200 dark:bg-neutral-800"})]}):t?.data}),n&&a.jsxs("p",{className:"border-slate-200 text-right text-sm dark:border-slate-800 ",children:["(此服务由"," ",a.jsx("a",{href:"https://xlog.app",target:"_blank",rel:"noreferrer",children:"xLog"})," ","驱动)"]})]})]});return(!r||o)&&(l=null),a.jsx(P,{duration:.2,className:"mt-4 print:hidden",children:l})},Ue=e=>e?.meta?.xLog?.cid;export{Fe as A,ze as B,qe as C,Se as M,Be as N,Ve as P,Oe as R,Ke as X,Ie as c,Ue as g,oe as p,He as q,fe as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./CommentRoot-gt5vN1ZY.js","./index-qegmBwH1.js","./index-SRCubG37.css","./index-_iJ2szeX.js","./index-wpIVlVRc.js","./owner-4YVbz2PN.js","./toast-qMk_Ov--.js","./init-a0893ef4-4662SO8Z.js","./helper-0r91fNX5.js","./StyledButton-Mj8l6PeD.js","./index-5Y6ZmVAf.js","./motion-minimal-gJqnz197.js","./store-gmK8mRDy.js","./env-y9k74Ds6.js","./Comments-P8C4VA5P.js","./useQuery-44y7CkOR.js","./spring--xEiX8r3.js","./image-sZM8elMx.js","./Markdown-hVdCypI9.js","./script-SYgWefdU.js","./FloatPopover-1BpKQIdq.js","./use-event-callback-nMlqCkS7.js","./use-is-client-IECHC2ux.js","./visual-element-YIiczwVf.js","./Gallery-MHeEsxti.js","./WrappedElementProvider-5243oAX6.js","./use-is-unmounted-6i0OwE-p.js","./lodash-Y39_oLIE.js","./WrappedElementProvider-v7JdpuAw.css","./Gallery-ktaGTCNz.css","./LinkCard-r30gHz-0.js","./usePeek-N6a5Jy_H.js","./provider-jumr72cx.js","./dom-NuJWIaAq.js","./LinkCard-P0Jx4JBj.css","./SocialSourceLink-c8HgVvxv.js","./CodeHighlighter-Sy1nPjje.js","./use-is-dark-13kBJDHw.js","./CodeHighlighter-hcFZa2QO.css","./Collapse-Q-wSwlx_.js","./Markdown-B8lEAZHM.css","./FlexText-sued5-2E.js","./AutoResizeHeight-pHZ_oyCK.js","./PinIconToggle-aUENNNd6.js","./Comments-rnEXEs_g.css","./FormInput-cQs6MTpb.js","./CurrentPostDataProvider-sxwUfZTo.js","./customParseFormat-3OBJgCTU.js","./index-RlvYxWmQ.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
