import{g as oe,c as ue,j as c,r as x,s as X,a as fe}from"./index-qegmBwH1.js";import{L as he,u as de,g as me}from"./image-sZM8elMx.js";import{c as re,a as pe}from"./helper-0r91fNX5.js";import{L as ge}from"./StyledButton-Mj8l6PeD.js";import{j as J,k as se}from"./owner-4YVbz2PN.js";import{b as ve,u as Y,a as be}from"./usePeek-N6a5Jy_H.js";import{a as xe}from"./use-is-client-IECHC2ux.js";import{p as ye}from"./dom-NuJWIaAq.js";import{m as we}from"./motion-minimal-gJqnz197.js";var S=(o=>(o.GHRepo="gh-repo",o.Self="self",o.MixSpace="mx-space",o.GHCommit="gh-commit",o.GHPr="gh-pr",o.TMDB="tmdb",o))(S||{}),je=function(o,e){e=e||{},e.listUnicodeChar=e.hasOwnProperty("listUnicodeChar")?e.listUnicodeChar:!1,e.stripListLeaders=e.hasOwnProperty("stripListLeaders")?e.stripListLeaders:!0,e.gfm=e.hasOwnProperty("gfm")?e.gfm:!0,e.useImgAltText=e.hasOwnProperty("useImgAltText")?e.useImgAltText:!0,e.abbr=e.hasOwnProperty("abbr")?e.abbr:!1,e.replaceLinksWithURL=e.hasOwnProperty("replaceLinksWithURL")?e.replaceLinksWithURL:!1,e.htmlTagsToSkip=e.hasOwnProperty("htmlTagsToSkip")?e.htmlTagsToSkip:[];var n=o||"";n=n.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*/gm,"");try{e.stripListLeaders&&(e.listUnicodeChar?n=n.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,e.listUnicodeChar+" $1"):n=n.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),e.gfm&&(n=n.replace(/\n={2,}/g,`
`).replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),e.abbr&&(n=n.replace(/\*\[.*\]:.*\n/,"")),n=n.replace(/<[^>]*>/g,"");var u=new RegExp("<[^>]*>","g");if(e.htmlTagsToSkip.length>0){var h="(?!"+e.htmlTagsToSkip.join("|")+")";u=new RegExp("<"+h+"[^>]*>","ig")}n=n.replace(u,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,e.useImgAltText?"$1":"").replace(/\[([^\]]*?)\][\[\(].*?[\]\)]/g,e.replaceLinksWithURL?"$2":"$1").replace(/^\s{0,3}>\s?/gm,"").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s+| {0,}(\n)?\s{0,}#{0,} #{0,}(\n)?\s{0,}$/gm,"$1$2$3").replace(/([\*]+)(\S)(.*?\S)??\1/g,"$2$3").replace(/(^|\W)([_]+)(\S)(.*?\S)??\2($|\W)/g,"$1$3$4$5").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/~(.*?)~/g,"$1")}catch(l){return console.error(l),o}return n};const _e=oe(je);var le={exports:{}};/**
* Generate unique and beautiful colors from any texts or numbers
 * @version v1.1.1
 * @link https://github.com/dastoori/uniqolor#README
 * @author Rasool Dastoori
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */(function(o,e){(function(n,u){o.exports=u()})(ue,function(){function n(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var a,f,b,g,w=[],_=!0,k=!1;try{if(b=(r=r.call(s)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(a=b.call(r)).done)&&(w.push(a.value),w.length!==t);_=!0);}catch(A){k=!0,f=A}finally{try{if(!_&&r.return!=null&&(g=r.return(),Object(g)!==g))return}finally{if(k)throw f}}return w}}function u(s,t){return i(s)||n(s,t)||p(s,t)||v()}function h(s){return l(s)||d(s)||p(s)||y()}function l(s){if(Array.isArray(s))return m(s)}function i(s){if(Array.isArray(s))return s}function d(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function p(s,t){if(s){if(typeof s=="string")return m(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(s,t)}}function m(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=s[r];return a}function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=[0,100],C=[0,100],$=function(t){return"".concat(t.length===1?"0":"").concat(t)},N=function(t,r,a){return Math.max(Math.min(t,a),r)},T=function(t,r){return Math.floor(Math.random()*(r-t+1))+t},K=function s(t,r,a){for(var f=T(t,r),b=0;b<a?.length;b++){var g=a[b];if(g?.length===2&&f>=g[0]&&f<=g[1])return s(t,r,a)}return f},O=function(t){for(var r=t.length,a=0,f=0;f<r;f++)a=(a<<5)-a+t.charCodeAt(f),a&=a;return a},F=function(t,r){return typeof r=="number"?r:t%Math.abs(r[1]-r[0])+r[0]},R=function(t,r){return typeof t=="number"?N.apply(void 0,[Math.abs(t)].concat(h(r))):t.length===1||t[0]===t[1]?N.apply(void 0,[Math.abs(t[0])].concat(h(r))):[Math.abs(N.apply(void 0,[t[0]].concat(h(r)))),N.apply(void 0,[Math.abs(t[1])].concat(h(r)))]},M=function(t,r,a){return a<0?a+=1:a>1&&(a-=1),a<1/6?t+(r-t)*6*a:a<1/2?r:a<2/3?t+(r-t)*(2/3-a)*6:t},P=function(t,r,a){var f,b,g;if(t/=360,r/=100,a/=100,r===0)f=b=g=a;else{var w=a<.5?a*(1+r):a+r-a*r,_=2*a-w;f=M(_,w,t+1/3),b=M(_,w,t),g=M(_,w,t-1/3)}return[Math.round(f*255),Math.round(b*255),Math.round(g*255)]},E=function(t,r,a,f){return(t*299+r*587+a*114)/1e3>=f},V=function(t,r,a){return"hsl(".concat(t,", ").concat(r,"%, ").concat(a,"%)")},B=function(t,r,a,f){switch(f){case"rgb":return"rgb(".concat(t,", ").concat(r,", ").concat(a,")");case"hex":default:return"#".concat($(t.toString(16))).concat($(r.toString(16))).concat($(a.toString(16)))}},W=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.format,f=a===void 0?"hex":a,b=r.saturation,g=b===void 0?[50,55]:b,w=r.lightness,_=w===void 0?[50,60]:w,k=r.differencePoint,A=k===void 0?130:k,I=Math.abs(O(String(t))),D=F(I,[0,360]),z=F(I,R(g,L)),H=F(I,R(_,C)),Z=P(D,z,H),U=u(Z,3),G=U[0],ee=U[1],te=U[2];return{color:f==="hsl"?V(D,z,H):B(G,ee,te,f),isLight:E(G,ee,te,A)}};return W.random=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=s.format,r=t===void 0?"hex":t,a=s.saturation,f=a===void 0?[50,55]:a,b=s.lightness,g=b===void 0?[50,60]:b,w=s.differencePoint,_=w===void 0?130:w,k=s.excludeHue;f=R(f,L),g=R(g,C);var A=k?K(0,359,k):T(0,359),I=typeof f=="number"?f:T.apply(void 0,h(f)),D=typeof g=="number"?g:T.apply(void 0,h(g)),z=P(A,I,D),H=u(z,3),Z=H[0],U=H[1],G=H[2];return{color:r==="hsl"?V(A,I,D):B(Z,U,G,r),isLight:E(Z,U,G,_)}},W})})(le);var $e=le.exports;const ce=oe($e);function Ne(o){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...o,children:c.jsxs("g",{fill:"none",fillRule:"evenodd",children:[c.jsx("path",{d:"M24 0v24H0V0h24ZM12.594 23.258l-.012.002l-.071.035l-.02.004l-.014-.004l-.071-.036c-.01-.003-.019 0-.024.006l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.016-.018Zm.264-.113l-.014.002l-.184.093l-.01.01l-.003.011l.018.43l.005.012l.008.008l.201.092c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.003-.011l.018-.43l-.003-.012l-.01-.01l-.184-.092Z"}),c.jsx("path",{fill:"currentColor",d:"M13.08 2.868a1.25 1.25 0 0 0-2.16 0L8.126 7.665L2.697 8.842a1.25 1.25 0 0 0-.667 2.054l3.7 4.141l-.56 5.525a1.25 1.25 0 0 0 1.748 1.27L12 19.592l5.082 2.24a1.25 1.25 0 0 0 1.748-1.27l-.56-5.525l3.7-4.14a1.25 1.25 0 0 0-.667-2.055l-5.428-1.176l-2.795-4.798ZM12 17.523c.172 0 .344.035.504.106l4.206 1.854l-.463-4.573a1.25 1.25 0 0 1 .312-.959l3.062-3.427l-4.492-.973a1.25 1.25 0 0 1-.816-.592L12 4.987v12.536Z"})]})})}const Te={typescript:"#2b7489",javascript:"#f1e05a",html:"#e34c26",java:"#b07219",go:"#00add8",vue:"#2c3e50",css:"#563d7c",yaml:"#cb171e",json:"#292929",markdown:"#083fa1",csharp:"#178600","c#":"#178600",c:"#555555",cpp:"#f34b7d","c++":"#f34b7d",python:"#3572a5",lua:"#000080",vimscript:"#199f4b",shell:"#89e051",dockerfile:"#384d54",ruby:"#701516",php:"#4f5d95",lisp:"#3fb68b",kotlin:"#F18E33",rust:"#dea584",dart:"#00B4AB",swift:"#ffac45","objective-c":"#438eff","objective-c++":"#6866fb",r:"#198ce7",matlab:"#e16737",scala:"#c22d40",sql:"#e38c00",perl:"#0298c3"},ae="https://api.github.com",ke="/api/gh",Q=o=>{const e=o.replace(ae,"");return Promise.any([fetch(ae+e).then(n=>{if(n.status===403)throw new Error("GitHub API rate limit exceeded");return n.json()}),fetch(ke+e).then(n=>n.json())])},q=Symbol(),Se=Symbol(),ie=typeof window>"u"||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?x.useEffect:x.useLayoutEffect,Ce=X.unstable_runWithPriority?o=>X.unstable_runWithPriority(X.unstable_NormalPriority,o):o=>o();function Me(o){const e=x.createContext({[q]:{v:{current:o},n:{current:-1},l:new Set,u:u=>u()}});var n;return e[Se]=e.Provider,e.Provider=(n=e.Provider,({value:u,children:h})=>{const l=x.useRef(u),i=x.useRef(0),[d,p]=x.useState(null);d&&(d(u),p(null));const m=x.useRef();if(!m.current){const y=new Set,v=(L,C)=>{fe.unstable_batchedUpdates(()=>{i.current+=1;const $={n:i.current};C!=null&&C.suspense&&($.n*=-1,$.p=new Promise(N=>{p(()=>T=>{$.v=T,delete $.p,N(T)})})),y.forEach(N=>N($)),L()})};m.current={[q]:{v:l,n:i,l:y,u:v}}}return ie(()=>{l.current=u,i.current+=1,Ce(()=>{m.current[q].l.forEach(y=>{y({n:i.current,v:u})})})},[u]),x.createElement(n,{value:m.current},h)}),delete e.Consumer,e}function Le(o,e){const n=x.useContext(o)[q],{v:{current:u},n:{current:h},l}=n,i=e(u),[d,p]=x.useReducer((m,y)=>{if(!y)return[u,i];if("p"in y)throw y.p;if(y.n===h)return Object.is(m[1],i)?m:[u,i];try{if("v"in y){if(Object.is(m[0],y.v))return m;const v=e(y.v);return Object.is(m[1],v)?m:[y.v,v]}}catch{}return[...m]},[u,i]);return Object.is(d[1],i)||p(),ie(()=>(l.add(p),()=>{l.delete(p)}),[l]),d[1]}const Re={tmdb:!1},Pe=Me(Re),Ee=o=>Le(Pe,e=>e[o]),Ae="_contents_1l4wo_25",Ie="_title_1l4wo_34",He="_desc_1l4wo_46",Ue="_image_1l4wo_56",Oe="_skeleton_1l4wo_66",Fe="_error_1l4wo_94",j={"card-grid":"_card-grid_1l4wo_1",contents:Ae,title:Ie,desc:He,image:Ue,skeleton:Oe,error:Fe},rt=o=>xe()?c.jsx(he,{placeholder:c.jsx(Ge,{}),children:c.jsx(De,{...o})}):null,De=o=>{const{id:e,source:n=S.Self,className:u,fallbackUrl:h}=o,[l,i]=x.useState(!0),[d,p]=x.useState(!1),[m,y]=x.useState(h||"javascript:;"),[v,L]=x.useState(),C=ve(),$=x.useCallback(async t=>{C(m)&&ye(t)},[m]),N=Ee("tmdb"),T=x.useCallback((t,r)=>{const a={[S.MixSpace]:ne,[S.GHRepo]:Ve,[S.GHCommit]:Be,[S.GHPr]:We,[S.Self]:ne};N&&(a[S.TMDB]=ze);const f=a[t];if(!f)return{isValid:!1,fetchFn:null};const b=f.isValid(r);return{isValid:b,fetchFn:b?f.fetch:null}},[N]),{isValid:K,fetchFn:O}=x.useMemo(()=>T(n,e),[n,e]),F=x.useCallback(async()=>{O&&(i(!0),await O(e,L,y).catch(t=>{console.log("fetch card info error: ",t),p(!0)}),i(!1))},[O,e]),{ref:R}=de({triggerOnce:!0,onChange(t){t&&F()}}),M=Y(0),P=Y(0),E=Y(0),V=x.useCallback(({clientX:t,clientY:r,currentTarget:a})=>{const f=a.getBoundingClientRect();M.set(t-f.left),P.set(r-f.top),E.set(Math.sqrt(f.width**2+f.height**2)*1.3)},[M,P,E]),B=be`radial-gradient(${E}px circle at ${M}px ${P}px, var(--spotlight-color) 0%, transparent 65%)`;if(!K)return null;const W=n==="self"?ge:"a",s=v?.classNames||{};return c.jsxs(W,{href:m,target:n!=="self"?"_blank":"_self",ref:R,className:re(j["card-grid"],(l||d)&&j.skeleton,d&&j.error,"group",u,s.cardRoot),style:{borderColor:v?.color?`${v.color}30`:""},onClick:$,onMouseMove:V,children:[v?.color&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"absolute inset-0 z-0",style:{backgroundColor:v?.color,opacity:.06}}),c.jsx(we.div,{layout:!0,className:"absolute inset-0 z-0 opacity-0 duration-500 group-hover:opacity-100",style:{"--spotlight-color":`${v?.color}50`,background:B}})]}),c.jsxs("span",{className:j.contents,children:[c.jsx("span",{className:j.title,children:v?.title}),c.jsx("span",{className:j.desc,children:v?.desc})]}),(l||v?.image)&&c.jsx("span",{className:re(j.image,s.image),"data-image":v?.image||"",style:{backgroundImage:v?.image?`url(${v.image})`:void 0}})]})},Ge=()=>c.jsxs("span",{className:pe(j["card-grid"],j.skeleton),children:[c.jsxs("span",{className:j.contents,children:[c.jsx("span",{className:j.title}),c.jsx("span",{className:j.desc})]}),c.jsx("span",{className:j.image})]}),Ve={isValid:o=>{const e=o.split("/");return e.length===2&&e[0].length>0&&e[1].length>0},fetch:async(o,e,n)=>{const[u,h]=o.split("/");try{const l=await Q(`https://api.github.com/repos/${u}/${h}`),i=J(l);e({title:c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"flex-1",children:i.name}),c.jsx("span",{className:"flex-shrink-0 self-end justify-self-end",children:i.stargazersCount>0&&c.jsxs("span",{className:"inline-flex flex-shrink-0 items-center gap-1 self-center text-sm text-orange-400 dark:text-yellow-500",children:[c.jsx("i",{className:"icon-[mingcute--star-line]"}),c.jsx("span",{className:"font-sans font-medium",children:i.stargazersCount})]})})]}),desc:i.description,image:i.owner.avatarUrl,color:Te[i.language?.toLowerCase()]}),n(i.htmlUrl)}catch(l){throw console.error("Error fetching GitHub data:",l),l}}},Be={isValid:o=>{const e=o.split("/");return e.length===4&&e.every(n=>n.length>0)&&e[2]==="commit"},fetch:async(o,e,n)=>{const[u,h,,l]=o.split("/");try{const i=await Q(`https://api.github.com/repos/${u}/${h}/commits/${l}`),d=J(i);e({title:c.jsx("span",{className:"font-normal",children:d.commit.message.replace(/Signed-off-by:.+/,"")}),desc:c.jsxs("span",{className:"flex items-center space-x-5 font-mono",children:[c.jsxs("span",{className:"text-uk-green-light",children:["+",d.stats.additions]}),c.jsxs("span",{className:"text-uk-red-light",children:["-",d.stats.deletions]}),c.jsx("span",{className:"text-sm",children:d.sha.slice(0,7)}),c.jsxs("span",{className:"text-sm opacity-80",children:[u,"/",h]})]}),image:d.author?.avatarUrl}),n(`https://github.com/${u}/${h}/commit/${l}`)}catch(i){throw console.error("Error fetching GitHub commit data:",i),i}}},We={isValid:o=>{const e=o.split("/");return e.length===3&&e.every(n=>n.length>0)},fetch:async(o,e,n)=>{const[u,h,,l]=o.split("/");try{const i=await Q(`https://api.github.com/repos/${u}/${h}/pulls/${l}`),d=J(i);e({title:`PR: ${d.title}`,desc:c.jsxs("span",{className:"flex items-center space-x-5 font-mono",children:[c.jsxs("span",{className:"text-uk-green-light",children:["+",d.additions]}),c.jsxs("span",{className:"text-uk-red-light",children:["-",d.deletions]}),c.jsxs("span",{className:"text-sm opacity-80",children:[u,"/",h]})]}),image:d.user.avatarUrl}),n(d.htmlUrl)}catch(i){throw console.error("Error fetching GitHub PR data:",i),i}}},ne={isValid:o=>{const[e,...n]=o.split("/");return e!=="posts"&&e!=="notes"?!1:e==="posts"?n.length===2:n.length===1},fetch:async(o,e,n)=>{const[u,...h]=o.split("/");try{let l={title:"",text:""};if(u==="posts"){const[p,m]=h;l=await se.post.getPost(p,m),n(`/posts/${p}/${m}`)}else if(u==="notes"){const[p]=h;l=(await se.note.getNoteById(+p)).data,n(`/notes/${p}`)}const i=l.cover||l.meta?.cover;let d="";if(i){const p=new Image;p.src=i,p.crossOrigin="Anonymous",p.onload=()=>{e(m=>m?.title!==l.title?m:{...m,color:me(p)})}}else d=ce(l.title,{saturation:[30,35],lightness:[60,70]}).color;e({title:l.title,desc:l.summary||`${_e(l.text).slice(0,50)}...`,image:i||l.images?.[0]?.src,color:d})}catch(l){throw console.error("Error fetching self data:",l),l}}},ze={isValid(o){const[e,n]=o.split("/");return["tv","movie"].includes(e)&&n.length>0},async fetch(o,e,n){const[u,h]=o.split("/");e({classNames:{cardRoot:"!w-full"}});const l=await fetch(`/api/tmdb/${u}/${h}?language=zh-CN`).then(p=>p.json()).catch(p=>{throw console.error("Error fetching TMDB data:",p),p}),i=u==="tv"?l.name:l.title,d=u==="tv"?l.original_name:l.original_title;e({title:c.jsxs("span",{className:"flex flex-wrap items-end gap-2",children:[c.jsx("span",{children:i}),i!==d&&c.jsxs("span",{className:"text-sm opacity-70",children:["(",d,")"]}),c.jsxs("span",{className:"inline-flex flex-shrink-0 items-center gap-1 self-center text-xs text-orange-400 dark:text-yellow-500",children:[c.jsx(Ne,{}),c.jsx("span",{className:"font-sans font-medium",children:l.vote_average>0&&l.vote_average.toFixed(1)})]})]}),desc:c.jsx("span",{className:"line-clamp-none overflow-visible whitespace-pre-wrap",children:l.overview}),image:`https://image.tmdb.org/t/p/w500${l.poster_path}`,color:ce(l.name,{saturation:[30,35],lightness:[60,70]}).color,classNames:{image:"self-start !h-[75px] !w-[50px]",cardRoot:"!w-full !flex-row-reverse"}}),l.homepage&&n(l.homepage)}};export{rt as L,_e as R,S as a,Ee as u};
